using System;
using System.Collections.Generic;
using System.Data.Odbc;
using System.Data.OleDb;
using Excel = Microsoft.Office.Interop.Excel;
using System.Data.SqlClient;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Data;

namespace sample_report_app
{
   class Program
   {
      static void Main(string[] args)
      {
         string connectionString = @"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\WORK\HR_Automation_projs\Reports\Sample_Database.accdb";
         string queryString = "select * from Employee";
         try
         {
            using (OleDbConnection connection = new OleDbConnection(connectionString))
            {
               OleDbCommand command = new OleDbCommand(queryString, connection);
              // SqlCommand cmd = new SqlCommand("SELECT * FROM Customers");
               //OleDbDataAdapter sda = new OleDbDataAdapter();
               //sda.SelectCommand = command;
               //DataTable dt = new DataTable();
               //sda.Fill(dt);
               connection.Open();

               OleDbDataReader reader = command.ExecuteReader
               var tb = new DataTable();
               tb.Load(reader);
               //SqlDataReader dr = command.ExecuteReader();

               Excel.Application xlApp = new Excel.Application();
             //  xlApp.Worksheets.Add(reader,"select");
               //xlApp.S
               
               xlApp.Worksheets.Add(tb, "select");
               //while (reader.Read())
               //{
               //   Console.ReadLine();
               //   Console.WriteLine(reader[0].ToString() + reader[1].ToString());
               //}
               //reader.Close();
            }
            Console.ReadLine();
            // OleDbConnection con = new OleDbConnection(@"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\WORK\HR_Automation_projs\Reports\Sample_Database.accdb");
            // OleDbCommand cmd = con.CreateCommand();
            // con.Open();
            // //cmd.CommandText = "UPDATE Employee SET ZIP = 3 WHERE SR=1 ";
            // //cmd.CommandText = "UPDATE Employee SET ZIP = 3 WHERE STATE = 'a' ";
            // cmd.CommandText = "UPDATE Employee SET ZIP = 4 WHERE [OFFICE PHONE NUMBER] = '1' "; 


            // cmd.Connection = con;
            //// SqlDataAdapter da = new SqlDataAdapter("data", con);
            // Console.WriteLine(cmd.ExecuteReader());

            // con.Close();
            // Console.ReadLine();
         }
         catch (Exception e)
         {
            Console.WriteLine(e);
            Console.ReadLine();
         }
      }
   }
   
}
